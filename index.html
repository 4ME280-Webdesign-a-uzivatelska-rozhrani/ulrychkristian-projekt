<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>Debug Cestovatelsk√Ω den√≠k</title>
  <style>
    body { font-family:sans-serif; max-width:600px; margin:2em auto; background:#f9f9f9; padding:1em; }
    .misto { background:#fff; padding:1em; margin-bottom:1em; border-radius:6px; }
    button { margin-top:.5em; }
  </style>
</head>
<body>
  <h1>üß≠ Debug Den√≠k</h1>
  <div class="sekce">
    <h2>üïì Chci nav≈°t√≠vit</h2>
    <div id="nenavstiveno"></div>
  </div>
  <div class="sekce">
    <h2>‚úÖ Nav≈°t√≠veno</h2>
    <div id="navstiveno"></div>
  </div>

  <script>
    console.log("‚Äì‚Äì SCRIPT START ‚Äì‚Äì");

    // 1) Naƒçti data
    let mista = JSON.parse(localStorage.getItem('mista') || '[]');
    console.log("Initial mista:", mista);

    // 2) Funkce vykresl√≠ obƒõ sekce a loguje stav
    function render() {
      console.log("‚Üí render() called, mista:", mista);
      const nen = document.getElementById("nenavstiveno");
      const nav = document.getElementById("navstiveno");
      nen.innerHTML = ""; nav.innerHTML = "";

      mista.forEach((item, i) => {
        const div = document.createElement("div");
        div.className = "misto";
        div.innerHTML = `
          <strong>${item.misto}</strong> (${item.datum})<br>
          navstiveno: ${item.navstiveno}
          <br><button data-index="${i}">
            ${item.navstiveno ? "Znovu na seznam" : "U≈æ jsem tu byl/a"}
          </button>
        `;
        const btn = div.querySelector("button");
        btn.addEventListener("click", () => {
          console.log("Button clicked on index", i);
          mista[i].navstiveno = !mista[i].navstiveno;
          localStorage.setItem('mista', JSON.stringify(mista));
          console.log("After toggle, mista:", mista);
          render();
        });
        if (item.navstiveno) nav.appendChild(div);
        else nen.appendChild(div);
      });
    }

    // 3) Pro test vlo≈æ√≠m p√°r uk√°zkov√Ωch dat, pokud je storage pr√°zdn√©
    if (mista.length === 0) {
      console.log("Storage pr√°zdn√© ‚Äì vkl√°d√°m demo data");
      mista = [
        { misto:"Test A", datum:"2024-01-01", popis:"", obrazek:"", navstiveno:false },
        { misto:"Test B", datum:"2024-02-02", popis:"", obrazek:"", navstiveno:true }
      ];
      localStorage.setItem('mista', JSON.stringify(mista));
    }

    // 4) Vykresli p≈ôi startu
    render();
  </script>
</body>
</html>
